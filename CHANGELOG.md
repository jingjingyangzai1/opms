# 更新日志

本文档记录运维管理系统的所有重要更新和改进。

格式说明：
- ✨ 新功能
- 🔧 改进/优化
- 🐛 错误修复
- 📝 文档更新
- 🔒 安全相关
- ⚡ 性能优化

---

## [1.1.0] - 2025-01-XX

### 新增功能

#### 前后端分离架构
- ✨ 实现前后端完全分离
  - 后端: Flask (端口 5000) 提供 RESTful API
  - 前端: React + Vite (端口 3000) 提供用户界面
  - 支持 Cookie 会话管理，前端自动携带认证信息
- ✨ 新增 React 前端项目结构
  - 使用 TypeScript 开发
  - 使用 Vite 作为构建工具
  - 实现 AuthContext 统一管理认证状态
  - ProtectedRoute 组件保护需要认证的路由

#### 一键启动功能
- ✨ Windows 一键启动脚本 (`start-all.bat`)
  - 自动启动 Flask 后端服务
  - 自动启动 React 前端开发服务器
  - 自动检查并安装前端依赖
  - 支持局域网访问（显示IP地址）
  - 友好的启动提示信息

#### 分页功能
- ✨ 资产列表分页浏览
  - 每页显示 50 条记录（可配置）
  - 分页信息显示："显示第 X-Y 行,共 Z 行 (第 A/B 页)"
  - 支持页码跳转、上一页/下一页、首页/末页
  - 智能页码显示（最多显示7个页码，超出显示省略号）
  - 当前页高亮显示（浅蓝色背景）

### 界面优化

#### 表格优化
- 🔧 扩大表格宽度
  - 最小宽度从 1200px 增加到 1600px
  - 优化各列最小宽度设置：
    - 资产名称: 180px
    - 类型: 120px
    - 状态: 100px
    - IP地址: 140px
    - 端口: 80px
    - 最后更新: 180px
    - 操作: 400px
  - 单元格内边距从 8px 增加到 15px，提升可读性

#### 操作菜单优化
- 🔧 更多操作菜单重构
  - 将编辑和删除放入"更多操作"菜单（倒三角按钮）
  - 防止用户误点删除资产
  - 删除操作增加双重确认提示
  - 简化菜单实现方式，使用直接的 onclick 绑定，提升可靠性
  - 菜单样式优化，深色主题适配

#### 分页控件设计
- 🔧 现代化分页控件
  - 左侧显示分页信息
  - 右侧显示分页按钮
  - 按钮样式：浅灰色背景，当前页浅蓝色高亮
  - 首页(«)、上一页(<)、页码、下一页(>)、末页(»)
  - 禁用状态样式优化

#### 间距优化
- 🔧 表格最后一行与滚动条间距
  - 表格容器底部预留 80px 空间
  - 最后一行单元格增加 80px 底部间距
  - 确保"更多操作"菜单展开时不被滚动条遮挡

### 技术改进

#### 前端架构
- 🔧 Vite 配置优化
  - 配置开发代理，自动转发 `/api` 请求到 Flask 后端
  - 支持 `socket.io` 代理转发
  - 允许局域网访问（`server.host: true`）
  - 固定前端端口为 3000

#### 后端 API
- 🔧 新增认证 API 端点
  - `/api/auth/login` - 用户登录（返回 JSON）
  - `/api/auth/logout` - 用户登出
  - `/api/auth/me` - 获取当前登录用户信息
  - 支持 Cookie 和 Session 管理

#### 代码优化
- 🔧 移除未使用的依赖
  - 从 `requirements.txt` 移除 `cymysql`（未实际使用）
- 🔧 缓存控制优化
  - 在 `base.html` 添加禁用缓存的 meta 标签
  - 确保浏览器总是加载最新版本

### 文档更新
- 📝 完善 README.md
  - 添加前后端分离模式启动说明
  - 更新项目结构说明
  - 添加分页功能说明
  - 更新功能特性列表
- 📝 创建 CHANGELOG.md
  - 详细记录所有更新和改进

---

## [1.0.1] - 2024-XX-XX

### 新增功能
- ✨ 新增 SFTP 文件管理功能
  - 文件浏览：浏览远程服务器文件系统，支持目录层级导航
  - 文件上传：上传本地文件到远程服务器
  - 文件下载：下载远程文件到本地
  - 目录导航：支持进入子目录和返回上级目录
  - 路径解析：自动解析用户home目录，支持 `~` 路径
  - 安全传输：使用SFTP协议，保障文件传输安全

### 改进
- 🔧 改进路径解析，支持 `~` home目录
- 🔧 修复路径构建问题（`~` 和 `/` 路径处理）
- 🔧 优化 base64 编码方式，避免大文件上传栈溢出
- 🔧 改进错误处理和超时控制
- 🔧 增强文件检查逻辑（区分文件和目录）

### 错误修复
- 🐛 修复文件上传失败问题
- 🐛 修复文件下载失败问题（路径构建和base64解码）

### 文档更新
- 📝 更新 README 文档，添加文件管理功能说明

---

## [1.0.0] - 2024-XX-XX

### 初始版本发布

#### 核心功能
- 🔐 用户认证系统
- 🖥️ 资产管理（训练系统资产、主控物理服务器）
- 🔄 SSH远程控制（重启、关机）
- 🖥️ SSH交互式终端
- 📊 实时状态监控
- 👥 用户管理

#### 部署支持
- 🚀 支持AlmaLinux 9.2一键离线部署
- 🐳 支持Docker部署
- 💻 支持Windows系统开发
- 📦 提供完整打包脚本

#### SSH终端功能
- ✨ SSH 终端窗口可拖拽调整大小
- ✨ SSH 终端窗口布局，内容区域自适应窗口大小
- ✨ 智能提示符管理，自动过滤冗余提示符
- ✨ 命令历史记录

#### 系统集成
- 🔧 集成systemd服务管理
- 🔧 支持开机自启动
- 🔧 完整的日志管理

### 错误修复
- 🐛 修复空命令回车不清屏的问题
- 🐛 修复输入命令时在错误位置显示的问题
- 🐛 修复多个命令执行后提示符消失的问题

### 已知问题
- 部分浏览器可能存在兼容性问题（已提供浏览器兼容性页面）

---

## 贡献指南

欢迎提交 Issue 和 Pull Request！

### 提交规范
- 使用清晰的提交信息
- 一个提交只包含一个功能或修复
- 提交前确保代码可以正常编译和运行

### 代码规范
- Python: 遵循 PEP 8
- JavaScript/TypeScript: 使用 ESLint
- HTML/CSS: 保持格式一致

---

## 版本说明

- **主版本号**: 不兼容的API修改
- **次版本号**: 向后兼容的功能性新增
- **修订号**: 向后兼容的问题修正

---

## 联系与支持

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至项目维护者

